# Managers - Системные менеджеры

## Назначение
Содержит основные менеджеры, которые управляют глобальными системами игры. Все менеджеры инициализируются через GameEntryPoint и регистрируются в CoreReferences.

## Текущее состояние проекта
На данном этапе разработки реализованы основные менеджеры игры, включая систему управления музыкой. Пулинг объектов будет добавлен позже.

## Основные компоненты

### GameManager
- **Назначение**: Центральный контроллер состояния игры
- **Ответственность**:
  - Управление состояниями (пауза, игра окончена, завершение уровня)
  - Отслеживание прогресса (убитые враги, собранные предметы, время игры)
  - Координация между другими системами через события
  - Debug-функции (перезапуск, пауза по клавишам)
- **События**: OnGamePaused, OnGameResumed, OnGameOver, OnLevelCompleted

### MusicManager
- **Назначение**: Управление фоновой музыкой в игре
- **Ответственность**:
  - Воспроизведение музыкальных треков
  - Управление громкостью музыки
  - Переключение между треками
  - Сохранение и загрузка настроек громкости
- **Методы**:
  - `SetMusicVolume(float volume)` - установка громкости (0-1)
  - `GetMusicVolume()` - получение текущей громкости
  - `PlayMusic(int trackIndex)` - воспроизведение трека по индексу
  - `PlayNextTrack()` / `PlayPreviousTrack()` - переключение треков
  - `StopMusic()` / `PauseMusic()` / `ResumeMusic()` - управление воспроизведением
- **Настройки**:
  - `musicSource` - AudioSource для воспроизведения (создается автоматически если не назначен)
  - `musicTracks` - массив музыкальных треков
  - `playOnStart` - воспроизводить ли музыку при старте
  - `loopMusic` - зацикливать ли музыку
- **Особенности**: Singleton паттерн, DontDestroyOnLoad, автоматическое создание AudioSource, интеграция с AudioSettings

### UIManager (упрощенный)
- **Назначение**: Управление дебаг информацией и базовым UI
- **Ответственность**:
  - Отображение FPS счетчика
  - Вывод дебаг информации о состоянии игры
  - Мониторинг состояния CoreReferences
  - Отображение времени игры и масштаба времени
- **Особенности**: На данном этапе упрощен до минимума, полноценный UI будет добавлен позже

## Принципы работы

1. **Инициализация**:
   - Все менеджеры создаются через GameEntryPoint
   - Автоматическая регистрация в CoreReferences
   - Проверка единственности каждого менеджера
   - Помечаются как DontDestroyOnLoad

2. **Взаимодействие**:
   - Связь через CoreReferences для быстрого доступа
   - События для слабо связанной архитектуры
   - Debug-методы для контроля состояния

3. **Безопасность**:
   - Проверка единственности каждого менеджера
   - Валидация ссылок перед использованием
   - Graceful degradation при отсутствии компонентов

## Зависимости
- **Исходящие**: Player, Weapons, Enemies, Environment
- **Входящие**: Core (CoreReferences, GameEntryPoint)
- **Взаимодействие**: UI (AudioSettings использует MusicManager для управления громкостью музыки)

## Планируемые расширения

### AudioManager (частично реализовано через MusicManager)
- ✅ Управление музыкой (реализовано через MusicManager)
- ✅ Управление громкостью музыки (реализовано через MusicManager и AudioSettings)
- ⏳ Управление звуковыми эффектами (SFX)
- ⏳ Объектный пулинг для 3D-звуков
- ⏳ Специализированные методы для оружия, врагов, окружения

### PoolManager (будет добавлен позже)
- Оптимизация производительности через переиспользование объектов
- Управление пулами пуль, эффектов, врагов
- Автоматический возврат объектов в пул

### Полноценный UIManager (будет расширен позже)
- Обновление HUD (здоровье, патроны, оружие)
- Управление меню (пауза, game over, завершение уровня)
- Визуальные эффекты (прицел, индикатор урона)
- Управление курсором и блокировкой

## Примечания
- Все менеджеры поддерживают debug-режим с расширенным логированием
- GameManager предоставляет debug-клавиши: P (пауза), F9 (перезапуск), F10 (game over)
- UIManager показывает состояние основных CoreReferences для отладки
- MusicManager интегрирован с системой меню (AudioSettings) для управления громкостью
- Архитектура готова для расширения - новые менеджеры легко добавляются через тот же паттерн
- MusicManager использует DontDestroyOnLoad для непрерывного воспроизведения музыки между сценами